# قاعدة البيانات السحابية - Netlify Wallet

## نظرة عامة
تم إنشاء قاعدة بيانات سحابية شاملة باستخدام Supabase لتخزين جميع بيانات التطبيق.

## الجداول المنشأة

### 1. جدول المستخدمين (users)
- معلومات الحساب الشخصية
- البريد الإلكتروني، الاسم، الهاتف
- رقم الحساب، تاريخ الانضمام
- الموقع، اللغة، العملة
- صورة الملف الشخصي

### 2. جدول الأرصدة (balances)
- رصيد الدينار الجزائري (DZD)
- رصيد اليورو (EUR)
- رصيد الدولار الأمريكي (USD)
- رصيد الجنيه الإسترليني (GBP)

### 3. جدول المعاملات (transactions)
- جميع العمليات المالية
- الشحن، التحويل، دفع الفواتير
- تحويل العملات، الاستثمارات
- حالة المعاملة ووصفها

### 4. جدول الاستثمارات (investments)
- الاستثمارات الأسبوعية والشهرية
- المبلغ المستثمر ونسبة الربح
- تاريخ البداية والنهاية
- حالة الاستثمار (نشط/مكتمل)

### 5. جدول أهداف الادخار (savings_goals)
- أهداف الادخار الشخصية
- المبلغ المستهدف والحالي
- الموعد النهائي والفئة
- الأيقونة واللون

### 6. جدول البطاقات (cards)
- البطاقات الصلبة والافتراضية
- رقم البطاقة ونوعها
- حالة التجميد وحدود الإنفاق

### 7. جدول الإشعارات (notifications)
- جميع إشعارات التطبيق
- النوع، العنوان، الرسالة
- حالة القراءة

### 8. جدول الإحالات (referrals)
- نظام إحالة الأصدقاء
- كود الإحالة ومبلغ المكافأة
- حالة الإحالة

## الميزات الأمنية

### Row Level Security (RLS)
- تم تفعيل الأمان على مستوى الصفوف
- كل مستخدم يمكنه الوصول لبياناته فقط
- سياسات أمان شاملة لجميع الجداول

### المصادقة
- نظام مصادقة متكامل مع Supabase Auth
- تسجيل دخول وإنشاء حساب آمن
- إدارة الجلسات تلقائياً

## الملفات المنشأة

### 1. `src/types/supabase.ts`
- تعريفات TypeScript لقاعدة البيانات
- أنواع البيانات لجميع الجداول

### 2. `src/lib/supabase.ts`
- إعداد عميل Supabase
- دوال المساعدة للعمليات الأساسية
- عمليات CRUD لجميع الجداول

### 3. `src/hooks/useAuth.ts`
- Hook للمصادقة
- تسجيل الدخول والخروج
- إدارة حالة المستخدم

### 4. `src/hooks/useDatabase.ts`
- Hook لعمليات قاعدة البيانات
- تحميل وتحديث البيانات
- إدارة الحالة المحلية

### 5. `database-setup.sql`
- سكريبت إنشاء قاعدة البيانات
- جميع الجداول والفهارس
- السياسات الأمنية والمحفزات

## متغيرات البيئة المطلوبة

يجب إضافة المتغيرات التالية في إعدادات المشروع:

```
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

## خطوات التفعيل

1. إنشاء مشروع جديد في Supabase
2. تشغيل سكريبت `database-setup.sql` في SQL Editor
3. إضافة متغيرات البيئة
4. تحديث التطبيق لاستخدام قاعدة البيانات

## الاستخدام في التطبيق

```typescript
// استخدام المصادقة
const { user, login, register, logout } = useAuth()

// استخدام قاعدة البيانات
const { 
  balance, 
  transactions, 
  investments,
  updateBalance,
  addTransaction,
  addInvestment 
} = useDatabase(user?.id)
```

## الميزات المتقدمة

- **Real-time Updates**: تحديثات فورية للبيانات
- **Offline Support**: دعم العمل بدون اتصال
- **Data Validation**: التحقق من صحة البيانات
- **Automatic Backups**: نسخ احتياطية تلقائية
- **Scalability**: قابلية التوسع العالية

## الأمان والخصوصية

- تشفير البيانات أثناء النقل والتخزين
- مصادقة متعددة العوامل
- تسجيل العمليات الأمنية
- حماية من هجمات SQL Injection
- سياسات الوصول المحدودة

تم إنشاء قاعدة بيانات شاملة وآمنة تدعم جميع ميزات التطبيق مع إمكانية التوسع المستقبلي.